/* This transducer makes sure that there is one additional space after the last character in an input line given that the last character is not a sentence marker.  This is needed because there needs to be a space after each tag */

package is.ru.cs.nlp.icenlp.core.iceparser;
import java.io.*;
%%

%public
%class Preprocess
%standalone
%line

%unicode

%{
  java.io.Writer out = new BufferedWriter(new OutputStreamWriter(System.out));
      
  public void parse(java.io.Writer _out) throws java.io.IOException
  {
      	out = _out;
      	while (!zzAtEOF) 
      	    yylex();
  }

  private String analyse(String txt)
  {	
	int len, lastIndex;
	String changedStr = txt;

	len = txt.length();
	lastIndex = len-1;
	
	if (lastIndex > 0) {
		Character chr = txt.charAt(lastIndex);
		if (Character.isLetter(chr))	// Then this letter is a part of a real tag and we may need a space after it 
			changedStr =  txt + " ";
	}
	return changedStr;			
  }
%}
  
%eof{
	try {
	  out.flush();	
	} 
	catch (IOException e) {
            e.printStackTrace();
        }
%eof}

Sentence = .+	
	
%%
{Sentence}	{ String changedStr, matchedStr;
		  int len;
			
		  matchedStr = yytext();
		  changedStr = analyse(matchedStr);
		  out.write(changedStr);
		}
"\n"		{ out.write("\n");}
